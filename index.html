<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Framework Benchmark Results</title>
    <!-- Include Chart.js from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="/assets/css/style.css" />
  </head>
  <body>
    <h1>Framework Benchmark Results</h1>
    <div id="results"></div>
    <div id="chart-container">
      <canvas id="benchmark-chart"></canvas>
    </div>
    <div id="fastest-framework"></div>
    <div id="last-updated"></div>
    <script>
      function loadAndDisplayResults() {
        fetch("benchmark_output.json")
          .then((response) => response.json())
          .then((data) => {
            const resultsDiv = document.getElementById("results");
            const lastUpdatedDiv = document.getElementById("last-updated");
            const chartContainer = document.getElementById("chart-container");
            const fastestFrameworkDiv =
              document.getElementById("fastest-framework");

            resultsDiv.innerHTML = ""; // Clear existing results
            fastestFrameworkDiv.innerHTML = "";

            const results = data.results;

            data.results.forEach((result) => {
              const resultElement = document.createElement("div");
              resultElement.className = "result";
              resultElement.textContent = `${result.name}: ${result.time} seconds`;
              resultsDiv.appendChild(resultElement);
            });

            // Display Last Updated At
            lastUpdatedDiv.textContent = `Last Updated At: ${data.lastUpdated}`;

            const chartData = {
              labels: results.map((result) => result.name),
              datasets: [
                {
                  label: "Rendering Time (seconds)",
                  backgroundColor: "rgba(75, 192, 192, 0.2)",
                  borderColor: "rgba(75, 192, 192, 1)",
                  borderWidth: 1,
                  data: results.map((result) => parseFloat(result.time)),
                },
              ],
            };

            const chartOptions = {
              scales: {
                y: {
                  beginAtZero: true,
                },
              },
            };

            const benchmarkChart = new Chart(
              document.getElementById("benchmark-chart"),
              {
                type: "bar",
                data: chartData,
                options: chartOptions,
              }
            );

            const fastestFramework = results.reduce((fastest, current) => {
              return parseFloat(current.time) < parseFloat(fastest.time)
                ? current
                : fastest;
            }, results[0]);

            // Display information about the fastest framework
            fastestFrameworkDiv.textContent = `Fastest Framework: ${fastestFramework.name} (${fastestFramework.time} seconds)`;
          })
          .catch((error) =>
            console.error("Error loading benchmark results:", error)
          );
      }

      // Load and display results initially
      loadAndDisplayResults();

      // Refresh results every 1 minute
      setInterval(loadAndDisplayResults, 1 * 60 * 1000);
    </script>
  </body>
</html>
